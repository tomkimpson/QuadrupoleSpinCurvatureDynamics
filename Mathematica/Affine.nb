(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     48000,       1238]
NotebookOptionsPosition[     43450,       1162]
NotebookOutlinePosition[     43785,       1177]
CellTagsIndexPosition[     43742,       1174]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"D", "[", "]"}]], "Input",
 CellChangeTimes->{{3.775394951224681*^9, 
  3.775394951579163*^9}},ExpressionUUID->"df771984-6a85-4b4e-b4f3-\
0d3a3ecd813e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"g00K", ",", "g11K", ",", "g22K", ",", "g33K", ",", "gCrossK"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"h00", ",", "h11", ",", "h22", ",", "h33"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var3", "=", 
    RowBox[{"{", 
     RowBox[{
     "g00dr", ",", "g00dt", ",", "g11dr", ",", "g11dt", ",", "g22dr", ",", 
      "g33dt", ",", "g33dr", ",", "g33dt", ",", "gCrossdr", ",", "gCrossdt"}],
      "}"}]}], " ", ";"}], "\[IndentingNewLine]", "       ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"D", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00K", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g00dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00K", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g00dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00K", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00K", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11K", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g11dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11K", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g11dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11K", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11K", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22K", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g22dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22K", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g22dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22K", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22K", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33K", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g33dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33K", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "g33dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33K", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33K", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33K", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossK", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "gCrossdr"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossK", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "gCrossdt"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossK", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossK", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var1"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"gCrossK", ",", "r"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"and", " ", "the", " ", "second", " ", "derivatives"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "g00dr", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g00dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dr", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g00dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dr", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g00drdr"}], "\[IndentingNewLine]", 
 RowBox[{"g00dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dr", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g00drdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00dr", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00dr", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g00dt", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g00dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dt", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g00dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dt", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g00dtdr"}], "\[IndentingNewLine]", 
 RowBox[{"g00dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g00dt", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g00dtdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g00dt", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g00dt", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g11dr", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g11dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dr", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g11dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dr", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g11drdr"}], "\[IndentingNewLine]", 
 RowBox[{"g11dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dr", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g11drdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11dr", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11dr", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g11dt", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g11dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dt", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g11dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dt", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g11dtdr"}], "\[IndentingNewLine]", 
 RowBox[{"g11dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g11dt", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g11dtdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g11dt", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g11dt", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g22dr", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g22dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dr", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g22dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dr", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g22drdr"}], "\[IndentingNewLine]", 
 RowBox[{"g22dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dr", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g22drdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22dr", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22dr", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g22dt", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g22dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dt", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g22dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dt", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g22dtdr"}], "\[IndentingNewLine]", 
 RowBox[{"g22dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g22dt", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g22dtdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22dt", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g22dt", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g33dr", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g33dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dr", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g33dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dr", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g33drdr"}], "\[IndentingNewLine]", 
 RowBox[{"g33dr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dr", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g33drdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33dr", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33dr", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g33dt", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"g33dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dt", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"g33dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dt", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g33dtdr"}], "\[IndentingNewLine]", 
 RowBox[{"g33dt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"g33dt", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "g33dtdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g33dt", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"g33dt", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "g33dr", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdr", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdr", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "gCrossdrdr"}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdr", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdr", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "gCrossdrdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossdr", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossdr", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "gCrossdt", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdt", ",", "t", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdt", ",", "r", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "gCrossdtdr"}], "\[IndentingNewLine]", 
 RowBox[{"gCrossdt", " ", "/:", 
  RowBox[{"D", "[", 
   RowBox[{"gCrossdt", ",", "\[Theta]", ",", 
    RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
  "gCrossdtdt"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gCrossdt", " ", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"gCrossdt", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var3"}]}], "]"}], " ", ":=", " ", 
   "0"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"and", " ", "the", " ", "perturbations"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h00", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h00", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h00dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h00", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h00", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h00dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h00", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h00", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h00", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h00", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h11", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h11", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h11dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h11", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h11", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h11dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h11", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h11", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h11", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h11", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h22", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h22", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h22dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h22", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h22", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h22dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h22", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h22", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h22", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h22", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h33", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h33", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h33dr"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h33", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h33", ",", "\[Theta]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "h33dt"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h33", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h33", ",", "\[Phi]", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h33", "/:", 
   RowBox[{"D", "[", 
    RowBox[{"h33", ",", "t", ",", 
     RowBox[{"NonConstants", "\[Rule]", "var2"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.774868202305891*^9, 3.774868401946373*^9}, {
  3.77486864675625*^9, 3.77486869363378*^9}, {3.7752165552955227`*^9, 
  3.775216574129471*^9}, {3.775218062288526*^9, 3.7752180885862293`*^9}, {
  3.775291687881701*^9, 3.775291712703828*^9}, {3.7753714705633087`*^9, 
  3.775371490620363*^9}, {3.7753716828910418`*^9, 3.775371718198251*^9}, {
  3.775371816079076*^9, 3.775371826857267*^9}, {3.7753718826955976`*^9, 
  3.7753720983005953`*^9}, {3.775372146279204*^9, 3.775372245911488*^9}, {
  3.775372314489349*^9, 3.7753724753814497`*^9}},
 CellLabel->
  "In[2358]:=",ExpressionUUID->"0652165e-234c-48ef-aa27-c21697d1d4d1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.775372320643173*^9, 3.7753723379362507`*^9}, {
  3.775372476514585*^9, 3.775372488596263*^9}},
 CellLabel->
  "Out[2383]=",ExpressionUUID->"81ed1914-43c4-45c1-9ed0-2e445e81cf00"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.774868245876919*^9, 
  3.774868245885934*^9}},ExpressionUUID->"036e07c2-34c8-482d-8333-\
0271537d4f9f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.774867624808189*^9, 3.7748676331583633`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8b999c32-acde-4c3c-be87-15fb124e0880"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Construct", " ", "the", " ", "perturbed"}], ",", " ", 
    RowBox[{"covariant", " ", "metric"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7748676550641823`*^9, 3.7748676719746923`*^9}, {
  3.774867737420066*^9, 3.774867752068544*^9}, {3.7748679003142776`*^9, 
  3.774867918079302*^9}, {3.774867977407682*^9, 3.7748679809485617`*^9}, {
  3.7752146841691723`*^9, 3.775214684443499*^9}, {3.7752168807262497`*^9, 
  3.775216898786274*^9}, {3.7752967341453123`*^9, 3.7752967370519648`*^9}, {
  3.7753714985357533`*^9, 3.775371499623508*^9}, {3.7753715825944643`*^9, 
  3.775371584817945*^9}, {3.77539533742099*^9, 
  3.775395338871571*^9}},ExpressionUUID->"2e537159-577f-4b4c-be32-\
44fa5b9fda2f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.775371585714171*^9, 3.7753717232855463`*^9, 
  3.77537225504784*^9},
 CellLabel->
  "Out[2099]=",ExpressionUUID->"3ffd5904-5754-47eb-bf7d-19d4a205799a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "And", " ", "then", " ", "define", " ", "the", " ", "contravariant", " ", 
    "form"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gbar", " ", "=", " ", 
     RowBox[{
      RowBox[{"g00", "*", "g33"}], " ", "-", " ", 
      SuperscriptBox["g03", "2"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"metricContra", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g33", "/", "gbar"}], ",", "0", ",", "0", ",", 
         RowBox[{"g03", "/", "gbar"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "g11"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"1", "/", "g22"}], ",", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"g03", "/", "gbar"}], ",", "0", ",", "0", ",", 
         RowBox[{"g11", "/", "gbar"}]}], "}"}]}], "}"}]}], ";"}]}]}]], "Input",\

 CellLabel->
  "In[2106]:=",ExpressionUUID->"d6699f13-ae80-46ed-a4b5-750d3ffee39b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coord", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", ":=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"affine", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"metricContra", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "s"}], "]"}], "]"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"coord", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{"[", 
               RowBox[{"s", ",", "k"}], "]"}], "]"}], ",", 
             RowBox[{"coord", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
             RowBox[{"coord", "[", 
              RowBox[{"[", "s", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7748677420966263`*^9, 3.774867778721038*^9}, 
   3.775291684484887*^9},
 CellLabel->
  "In[2108]:=",ExpressionUUID->"1ffc4755-fd72-4bab-ae1a-e2664daf23db"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sfile", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{
      "\"\</Users/tomkimpson/PhD/Projects/QuadrupoleDynamics/Mathematica/test.\
txt\>\"", ",", 
       RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"string1", " ", "=", " ", 
        RowBox[{"\"\<G\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"j", "-", "1"}], "]"}], "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"k", "-", "1"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"string2", "=", 
        RowBox[{"\"\<=\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"FortranForm", "[", 
           RowBox[{"affine", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}], "]"}], 
         "<>", "\"\<\\n\>\""}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"string2", " ", "=", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"string2", ",", 
          RowBox[{"\"\<=0\>\"", "\[Rule]", "\"\<=0.0_dp\>\""}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"string2", " ", "=", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"string2", ",", 
          RowBox[{"\"\<2*\>\"", "\[Rule]", "\"\<2.0_dp*\>\""}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"string2", " ", "=", " ", 
        RowBox[{"StringReplace", "[", 
         RowBox[{"string2", ",", 
          RowBox[{"\"\</2.\>\"", "\[Rule]", "\"\</2.0_dp\>\""}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"string", " ", "=", " ", 
        RowBox[{"string1", "<>", "string2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{"sfile", ",", "string"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Close", "[", "sfile", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQbaTcKLdc4Y2jn9hCFRAtr3tDE0Rn5T/WBdHnpJqN
QPSn1+KWIFpJxsAWRKsKvQoA0UFXZWNBtEZRWyGIPrTvXhWITtkQVA2ie80k
60F095+/DSA6pPFUO4j+ts2+F0TzhOnMAtE79s0H0xkm20+AaI/s4ydBtEVx
4UWwebuvXAbRr14duw6ij5kLPgDRYTNtn4PoCLlFYPrcgfa3IPqZ3CwwnaSw
5huItvm5+A+I5pr0n2kFyB+LLVlAdNtxNg4QzfjGWQBEO3CfDgPRXJ41kSD6
wLuGPBA9q2d+OYi+JcLcCKI/FEh3gOglm299PA2keXu9GM8A6Xfc19hB9JVl
tzhB9JHOlVIgOvxXogyIVvDz0wbRFfNaLEH0ccZzH0A006KrYBoAqt/FxQ==

  "],
 CellLabel->
  "In[2111]:=",ExpressionUUID->"097def15-ccd7-4afd-b959-665ce154c9c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Riemann", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k", ",", "m"}], "]"}], "]"}], ",", 
        RowBox[{"coord", "[", 
         RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"affine", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
        RowBox[{"coord", "[", 
         RowBox[{"[", "m", "]"}], "]"}]}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "s", ",", "l"}], "]"}], "]"}], "*", 
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "k", ",", "m"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "s", ",", "m"}], "]"}], "]"}], "*", 
         RowBox[{"affine", "[", 
          RowBox[{"[", 
           RowBox[{"s", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7752963449233627`*^9, 3.775296367418374*^9}, {
   3.775296441287327*^9, 3.775296466837914*^9}, 3.775296622516037*^9},
 CellLabel->
  "In[2114]:=",ExpressionUUID->"8c722f69-fc10-456b-8020-9e5edd6748d1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"thing", " ", "=", " ", 
  RowBox[{"affine", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1", ",", "4"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.775296472375823*^9, 3.775296493117372*^9}, {
  3.7752965739957857`*^9, 3.775296680285962*^9}, {3.775296750374178*^9, 
  3.775296762084387*^9}, {3.775296801698513*^9, 3.7752968298874702`*^9}, {
  3.7752968633891897`*^9, 3.775297122822033*^9}, {3.775371530362422*^9, 
  3.7753715577149487`*^9}, {3.7753716558326797`*^9, 3.775371656876197*^9}},
 CellLabel->
  "In[2115]:=",ExpressionUUID->"eec87aec-da5f-443b-8354-70674ca7ed01"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "g11K"}]], 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", "r", ",", 
     RowBox[{"NonConstants", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "g00dr", ",", "g00dt", ",", "g00K", ",", "g11dr", ",", "g11dt", ",", 
        "g11K", ",", "g22dr", ",", "g22K", ",", "g33dr", ",", "g33dt", ",", 
        "g33dt", ",", "g33K", ",", "gCrossdr", ",", "gCrossdt", ",", 
        "gCrossK", ",", "h00", ",", "h11", ",", "h22", ",", "h33"}], 
       "}"}]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.775296760240528*^9, 3.775296762343883*^9}, {
   3.775296818930935*^9, 3.775296830513854*^9}, {3.775296869540286*^9, 
   3.7752968748157682`*^9}, {3.775296912467019*^9, 3.7752969400506163`*^9}, 
   3.7752970078514023`*^9, {3.775297040879241*^9, 3.77529706242339*^9}, {
   3.775297105305245*^9, 3.775297124153562*^9}, {3.775371512507848*^9, 
   3.77537155820868*^9}, 3.775371595261198*^9, 3.775371657614855*^9, 
   3.7753717331223373`*^9, 3.77537226460357*^9},
 CellLabel->
  "Out[2115]=",ExpressionUUID->"1c92e3fd-963a-4fb8-b691-53b45528233e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"thing", ",", "r"}], "]"}]], "Input",
 CellChangeTimes->{{3.77537160374361*^9, 3.7753716059838133`*^9}},
 CellLabel->
  "In[1936]:=",ExpressionUUID->"d1551737-9bb3-4e58-b124-2efe003b0328"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     SuperscriptBox["g11K", "2"]}]], 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"g11K", ",", "r", ",", 
      RowBox[{"NonConstants", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "g00dr", ",", "g00dt", ",", "g00K", ",", "g11dr", ",", "g11dt", ",", 
         "g11K", ",", "g22dr", ",", "g22K", ",", "g33dr", ",", "g33dt", ",", 
         "g33dt", ",", "g33K", ",", "gCrossdr", ",", "gCrossdt", ",", 
         "gCrossK", ",", "h00", ",", "h11", ",", "h22", ",", "h33"}], 
        "}"}]}]}], "]"}], " ", 
    RowBox[{"D", "[", 
     RowBox[{"gCrossK", ",", "r", ",", 
      RowBox[{"NonConstants", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "g00dr", ",", "g00dt", ",", "g00K", ",", "g11dr", ",", "g11dt", ",", 
         "g11K", ",", "g22dr", ",", "g22K", ",", "g33dr", ",", "g33dt", ",", 
         "g33dt", ",", "g33K", ",", "gCrossdr", ",", "gCrossdt", ",", 
         "gCrossK", ",", "h00", ",", "h11", ",", "h22", ",", "h33"}], 
        "}"}]}]}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", "g11K"}]], 
   RowBox[{"D", "[", 
    RowBox[{"gCrossK", ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "2"}], "}"}], ",", 
     RowBox[{"NonConstants", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "g00dr", ",", "g00dt", ",", "g00K", ",", "g11dr", ",", "g11dt", ",", 
        "g11K", ",", "g22dr", ",", "g22K", ",", "g33dr", ",", "g33dt", ",", 
        "g33dt", ",", "g33K", ",", "gCrossdr", ",", "gCrossdt", ",", 
        "gCrossK", ",", "h00", ",", "h11", ",", "h22", ",", "h33"}], 
       "}"}]}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.7753716065547533`*^9, 3.775371662262829*^9, 
  3.775371733431877*^9},
 CellLabel->
  "Out[1936]=",ExpressionUUID->"d62572c8-48cc-468e-86f7-b82124e587c3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.775296472501107*^9, 
  3.775296474095201*^9}},ExpressionUUID->"5f1ade1c-4718-41ba-8b28-\
78704192eb15"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.775296372106224*^9, 3.775296377233584*^9}, 
   3.775296447095159*^9},ExpressionUUID->"a659f3d3-928b-4f54-9415-\
974ef6ee5919"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.775291502846959*^9, 3.775291593120921*^9}, 
   3.775293324581697*^9, 3.775293662312111*^9, 
   3.775296337549048*^9},ExpressionUUID->"16a19d7d-7a48-4858-852e-\
2866aa8cbd56"],

Cell[BoxData["\<\"0\"\>"], "Output",
 CellChangeTimes->{{3.775291511568548*^9, 3.775291593615881*^9}},
 CellLabel->
  "Out[807]=",ExpressionUUID->"3baf9e73-e2dc-41d5-817f-6f47a40fd2e0"],

Cell[BoxData["\<\"0.0_dp\"\>"], "Output",
 CellChangeTimes->{{3.775291511568548*^9, 3.775291593619644*^9}},
 CellLabel->
  "Out[808]=",ExpressionUUID->"35199c72-64a5-43b3-957e-da0a705fb77e"],

Cell[BoxData["\<\"0\"\>"], "Output",
 CellChangeTimes->{{3.775291511568548*^9, 3.77529159362324*^9}},
 CellLabel->
  "Out[809]=",ExpressionUUID->"ad6a842b-1616-441c-b33e-956161dc8b3e"],

Cell[BoxData["\<\"0.0_dp\"\>"], "Output",
 CellChangeTimes->{{3.775291511568548*^9, 3.775291593625086*^9}},
 CellLabel->
  "Out[810]=",ExpressionUUID->"9cf4c411-85d1-4804-9239-a98a1552a916"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\</Users/tomkimpson/PhD/Projects/QuadrupoleDynamics/Mathematica/\
affine.txt\>\"", ",", "affine", ",", " ", "\"\<Table\>\""}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sfile", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{
      "\"\</Users/tomkimpson/PhD/Projects/QuadrupoleDynamics/Mathematica/\
affine.txt\>\"", ",", 
       RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}]}], ";", 
    "\n", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", "4"}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "4"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "4"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Write", "[", 
           RowBox[{
           "sfile", ",", "\"\<G\>\"", ",", "i", ",", "\"\<_\>\"", ",", " ", 
            "j", ",", "k", ",", " ", "\"\<=\>\"", ",", " ", 
            RowBox[{"FortranForm", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{"affine", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}], 
             "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}],
     ";"}], "\n", "*)"}], "\n", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7748677819278097`*^9, 3.774867798240676*^9}, {
   3.7748679432504587`*^9, 3.774867943786644*^9}, {3.774868175460906*^9, 
   3.774868177013544*^9}, {3.7748684129573193`*^9, 3.774868424342211*^9}, {
   3.7748685087477827`*^9, 3.7748685220311537`*^9}, {3.774868571574195*^9, 
   3.77486862176333*^9}, {3.775214812781892*^9, 3.775214875301169*^9}, {
   3.775214959679942*^9, 3.7752149603040113`*^9}, {3.775215053924122*^9, 
   3.775215067863091*^9}, {3.775215170103441*^9, 3.775215421845086*^9}, {
   3.775215484974613*^9, 3.775215513920631*^9}, {3.775215562492426*^9, 
   3.775215619547106*^9}, {3.775215655715613*^9, 3.7752156573303537`*^9}, {
   3.7752157207171373`*^9, 3.775215730815507*^9}, {3.775215836544188*^9, 
   3.7752158549540977`*^9}, 
   3.775216642365415*^9},ExpressionUUID->"eb973677-4886-42d5-9929-\
3d17335dd015"],

Cell[BoxData[
 TemplateBox[{
  "OpenWrite","aofil",
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\) already open as \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\).\"",2,312,71,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826686716*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"2f1b1ca9-b498-4423-b7e4-19804d0fac70"],

Cell[BoxData[
 TemplateBox[{
  "OpenWrite","noopen",
   "\"Cannot open \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\).\"",2,312,72,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826802109*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"60ea8bad-1a0a-49ae-a02a-48988ce06791"],

Cell[BoxData[
 TemplateBox[{
  "OpenWrite","aofil",
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\) already open as \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\).\"",2,313,73,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826807836*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"50cdb429-5b0a-4dd8-b4e4-7c5900179ec7"],

Cell[BoxData[
 TemplateBox[{
  "OpenWrite","noopen",
   "\"Cannot open \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/tomkimpson/PhD/Projects/\
QuadrupoleDynamics/Mathematica/affine.txt\\\\\\\"\\\"}]\\).\"",2,313,74,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7752158268135233`*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"129bc7de-52ba-4fbf-b157-d41804c0ac89"],

Cell[BoxData[
 TemplateBox[{
  "Write","strml",
   "\"\\!\\(\\*RowBox[{\\\"$Failed\\\"}]\\) is not a string, stream, or list \
of strings and streams.\"",2,314,75,33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826818529*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"4e080cde-e83b-4286-b4c4-12ee99cf80c6"],

Cell[BoxData[
 TemplateBox[{
  "Write","strml",
   "\"\\!\\(\\*RowBox[{\\\"$Failed\\\"}]\\) is not a string, stream, or list \
of strings and streams.\"",2,314,76,33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826823494*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"cb626f4d-e6f7-4ae2-8c62-cc24d5cda044"],

Cell[BoxData[
 TemplateBox[{
  "Write","strml",
   "\"\\!\\(\\*RowBox[{\\\"$Failed\\\"}]\\) is not a string, stream, or list \
of strings and streams.\"",2,314,77,33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7752158268280783`*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"1ee7fd01-da79-4f6c-9f96-5c9fa66c4a30"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Write\\\", \\\"::\\\", \
\\\"strml\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,314,78,33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.775215826832746*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"c0724f0e-ade6-4230-804b-441383d9b583"],

Cell[BoxData[
 TemplateBox[{
  "Close","stream",
   "\"\\!\\(\\*RowBox[{\\\"$Failed\\\"}]\\) is not a string, SocketObject, \
InputStream[ ], or OutputStream[ ].\"",2,315,79,33879090070699448879,"Local"},
  
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7752158268377457`*^9},
 CellLabel->
  "During evaluation of \
In[311]:=",ExpressionUUID->"16cdfaeb-c149-40fe-b8c6-3fe8f150653b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.775215352833517*^9, 
  3.775215352847294*^9}},ExpressionUUID->"7e51c6a4-9f16-4a37-b0fd-\
babfd8a4d1c2"],

Cell[BoxData[
 TemplateBox[{
  "Format","toobig","\"Expression too big for output.\"",2,252,17,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.775215278538621*^9, 3.7752152984729424`*^9}, 
   3.775215348192697*^9},
 CellLabel->
  "During evaluation of \
In[249]:=",ExpressionUUID->"6305776a-7d01-4ee3-9543-9f023a6ad2d4"],

Cell[BoxData[
 TemplateBox[{
  "Format","toobig","\"Expression too big for output.\"",2,252,18,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.775215278538621*^9, 3.7752152984729424`*^9}, 
   3.775215348201079*^9},
 CellLabel->
  "During evaluation of \
In[249]:=",ExpressionUUID->"515c76cf-fd7d-46fc-ae1a-60242167d417"],

Cell[BoxData[
 TemplateBox[{
  "Format","toobig","\"Expression too big for output.\"",2,252,19,
   33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.775215278538621*^9, 3.7752152984729424`*^9}, 
   3.775215348206643*^9},
 CellLabel->
  "During evaluation of \
In[249]:=",ExpressionUUID->"fd911832-2d61-42b1-b240-894d789ceffb"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Format\\\", \\\"::\\\", \
\\\"toobig\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,252,20,33879090070699448879,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.775215278538621*^9, 3.7752152984729424`*^9}, 
   3.775215348211753*^9},
 CellLabel->
  "During evaluation of \
In[249]:=",ExpressionUUID->"1c9b9e1d-a1eb-4984-a763-317f2ece16ea"],

Cell[BoxData["\<\"/Users/tomkimpson/PhD/Projects/QuadrupoleDynamics/\
Mathematica/affine.txt\"\>"], "Output",
 CellChangeTimes->{{3.774867786074996*^9, 3.7748677984525146`*^9}, {
   3.7748679247408*^9, 3.77486794502564*^9}, {3.774867986651372*^9, 
   3.774868001840719*^9}, 3.7748681775031223`*^9, {3.774868410998765*^9, 
   3.7748684247711563`*^9}, 3.774868522941176*^9, {3.7748685781565237`*^9, 
   3.774868623025716*^9}, 3.775214704764184*^9, 3.775214876642746*^9, 
   3.775214961248166*^9, 3.775215232534622*^9, {3.775215278552876*^9, 
   3.775215298487032*^9}, 3.775215348217194*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"25277789-3309-4b0c-a510-411b3fc1feba"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.774868144703288*^9, 3.774868173510923*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"80cc8a40-34cc-4f19-8538-bcfad5dd4f50"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.774867676639305*^9, 3.774867680333699*^9}, 
   3.774867728039178*^9},ExpressionUUID->"f00f92de-7c46-4d0e-b3e8-\
c3e00ef4d1a3"],

Cell[BoxData[
 RowBox[{"g11_dr", "+", 
  RowBox[{"2", " ", "g11K", " ", "h11", " ", "\[Epsilon]", " ", "g11_dr"}], 
  "+", 
  RowBox[{
   SuperscriptBox["g11K", "2"], " ", "\[Epsilon]", " ", 
   "h11_dr"}]}]], "Output",
 CellChangeTimes->{3.774867681006062*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"2d28f3ea-4669-429f-9a35-434ed4168777"]
}, Open  ]]
},
WindowSize->{720, 855},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 175, 4, 30, "Input",ExpressionUUID->"df771984-6a85-4b4e-b4f3-0d3a3ecd813e"],
Cell[CellGroupData[{
Cell[600, 21, 18166, 481, 2131, "Input",ExpressionUUID->"0652165e-234c-48ef-aa27-c21697d1d4d1"],
Cell[18769, 504, 229, 4, 34, "Output",ExpressionUUID->"81ed1914-43c4-45c1-9ed0-2e445e81cf00"]
}, Open  ]],
Cell[19013, 511, 152, 3, 30, "Input",ExpressionUUID->"036e07c2-34c8-482d-8333-0271537d4f9f"],
Cell[19168, 516, 173, 2, 30, "Input",ExpressionUUID->"8b999c32-acde-4c3c-be87-15fb124e0880"],
Cell[CellGroupData[{
Cell[19366, 522, 787, 15, 52, "Input",ExpressionUUID->"2e537159-577f-4b4c-be32-44fa5b9fda2f"],
Cell[20156, 539, 202, 4, 34, "Output",ExpressionUUID->"3ffd5904-5754-47eb-bf7d-19d4a205799a"]
}, Open  ]],
Cell[20373, 546, 1128, 32, 94, "Input",ExpressionUUID->"d6699f13-ae80-46ed-a4b5-750d3ffee39b"],
Cell[21504, 580, 2008, 56, 199, "Input",ExpressionUUID->"1ffc4755-fd72-4bab-ae1a-e2664daf23db"],
Cell[23515, 638, 2984, 71, 367, "Input",ExpressionUUID->"097def15-ccd7-4afd-b959-665ce154c9c4"],
Cell[26502, 711, 1931, 53, 115, "Input",ExpressionUUID->"8c722f69-fc10-456b-8020-9e5edd6748d1"],
Cell[CellGroupData[{
Cell[28458, 768, 603, 11, 30, "Input",ExpressionUUID->"eec87aec-da5f-443b-8354-70674ca7ed01"],
Cell[29064, 781, 1131, 23, 96, "Output",ExpressionUUID->"1c92e3fd-963a-4fb8-b691-53b45528233e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30232, 809, 232, 5, 30, "Input",ExpressionUUID->"d1551737-9bb3-4e58-b124-2efe003b0328"],
Cell[30467, 816, 1841, 45, 223, "Output",ExpressionUUID->"d62572c8-48cc-468e-86f7-b82124e587c3"]
}, Open  ]],
Cell[32323, 864, 152, 3, 30, "Input",ExpressionUUID->"5f1ade1c-4718-41ba-8b28-78704192eb15"],
Cell[32478, 869, 175, 3, 30, "Input",ExpressionUUID->"a659f3d3-928b-4f54-9415-974ef6ee5919"],
Cell[CellGroupData[{
Cell[32678, 876, 223, 4, 30, "Input",ExpressionUUID->"16a19d7d-7a48-4858-852e-2866aa8cbd56"],
Cell[32904, 882, 185, 3, 34, "Output",ExpressionUUID->"3baf9e73-e2dc-41d5-817f-6f47a40fd2e0"],
Cell[33092, 887, 190, 3, 34, "Output",ExpressionUUID->"35199c72-64a5-43b3-957e-da0a705fb77e"],
Cell[33285, 892, 184, 3, 34, "Output",ExpressionUUID->"ad6a842b-1616-441c-b33e-956161dc8b3e"],
Cell[33472, 897, 190, 3, 34, "Output",ExpressionUUID->"9cf4c411-85d1-4804-9239-a98a1552a916"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33699, 905, 2528, 54, 346, "Input",ExpressionUUID->"eb973677-4886-42d5-9929-3d17335dd015"],
Cell[36230, 961, 554, 12, 42, "Message",ExpressionUUID->"2f1b1ca9-b498-4423-b7e4-19804d0fac70"],
Cell[36787, 975, 430, 11, 24, "Message",ExpressionUUID->"60ea8bad-1a0a-49ae-a02a-48988ce06791"],
Cell[37220, 988, 554, 12, 42, "Message",ExpressionUUID->"50cdb429-5b0a-4dd8-b4e4-7c5900179ec7"],
Cell[37777, 1002, 432, 11, 24, "Message",ExpressionUUID->"129bc7de-52ba-4fbf-b157-d41804c0ac89"],
Cell[38212, 1015, 382, 9, 24, "Message",ExpressionUUID->"4e080cde-e83b-4286-b4c4-12ee99cf80c6"],
Cell[38597, 1026, 382, 9, 24, "Message",ExpressionUUID->"cb626f4d-e6f7-4ae2-8c62-cc24d5cda044"],
Cell[38982, 1037, 384, 9, 24, "Message",ExpressionUUID->"1ee7fd01-da79-4f6c-9f96-5c9fa66c4a30"],
Cell[39369, 1048, 446, 10, 24, "Message",ExpressionUUID->"c0724f0e-ade6-4230-804b-441383d9b583"],
Cell[39818, 1060, 398, 10, 24, "Message",ExpressionUUID->"16cdfaeb-c149-40fe-b8c6-3fe8f150653b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40253, 1075, 152, 3, 30, "Input",ExpressionUUID->"7e51c6a4-9f16-4a37-b0fd-babfd8a4d1c2"],
Cell[40408, 1080, 370, 9, 24, "Message",ExpressionUUID->"6305776a-7d01-4ee3-9543-9f023a6ad2d4"],
Cell[40781, 1091, 370, 9, 24, "Message",ExpressionUUID->"515c76cf-fd7d-46fc-ae1a-60242167d417"],
Cell[41154, 1102, 370, 9, 24, "Message",ExpressionUUID->"fd911832-2d61-42b1-b240-894d789ceffb"],
Cell[41527, 1113, 500, 11, 24, "Message",ExpressionUUID->"1c9b9e1d-a1eb-4984-a763-317f2ece16ea"],
Cell[42030, 1126, 671, 10, 34, "Output",ExpressionUUID->"25277789-3309-4b0c-a510-411b3fc1feba"]
}, Open  ]],
Cell[42716, 1139, 175, 3, 30, "Input",ExpressionUUID->"80cc8a40-34cc-4f19-8538-bcfad5dd4f50"],
Cell[CellGroupData[{
Cell[42916, 1146, 175, 3, 30, "Input",ExpressionUUID->"f00f92de-7c46-4d0e-b3e8-c3e00ef4d1a3"],
Cell[43094, 1151, 340, 8, 34, "Output",ExpressionUUID->"2d28f3ea-4669-429f-9a35-434ed4168777"]
}, Open  ]]
}
]
*)

